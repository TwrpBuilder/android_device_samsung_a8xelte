language: java
jdk:
- openjdk7
sudo: required
before_script:
- cd $HOME
- sudo apt-get install -y lzop git-core gnupg flex bison gperf build-essential zip
  curl zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev
  libx11-dev lib32z-dev ccache libgl1-mesa-dev libxml2-utils xsltproc unzip maven
  schedtool &> /dev/null
- git clone https://sumitrajdev@bitbucket.org/sumitrajdev/twrp-5.1.1.git $HOME/tmp
- mv $HOME/tmp/twrp-5.1.1.tar.xz $HOME/twrp.tar.xz
- rm -rf tmp
- wget https://github.com/TwrpBuilder/twrp-5.1.1-source/releases/download/initial/twrp-5.1.1.tar.xz
  -O $HOME/twrp.tar.xz
- tar -xvf twrp.tar.xz &> log
script:
- cd $HOME/twrp
- git clone https://github.com/TwrpBuilder/android_device_a8xelte.git device/samsung/a8xelte
- rm -rf bootable/recovery
- git clone https://github.com/omnirom/android_bootable_recovery.git bootable/recovery
- source build/envsetup.sh ; lunch omni_a8xelte-eng
- make -j4 recoveryimage
- cd out/target/product/a8xelte/
- curl --upload-file "./recovery.img" "https://transfer.sh/recovery.img"

deploy:
  skip_cleanup: true
  provider: releases
  api_key:
    secure: ghndrTlq4yJLLZcFhjHT1ppOvBczBIh4MBsIqMSydytekQ2VwyJclLQ+mgq3Q0P5iATxA6yjmHaZ++MVwStEJu5q4ViltKOtlosz32u/yBY0DsY6PqL5/KXnySCxunDBVarRi9sKy8h0DgkxL/iGx12dXWO7p02f0Mt6xsZ15CK82mNe+kqrFEs4uTeWiwsO+1PbCuo09aueOGxrWCV12faz9mr8fgRLhInLDEpuZBaApBYiO/ANROhhqADmOXNuN2hLwbrJrAlohffiSy4oPHXQ8lMz8Mx48k4hokanqUJbqLggvCe9vWj2PLSQvwNSw+Tri6L2zFenowqwLeoRuLbn+tJzu/hCqlGYjcSdX6Wm3T7Vr7Gqb9dhay/NNwyxdFqNfurBiLQWtGaA+zGdGMRPw6K2XKZrzhIUONg60BlCqy5ghmzlWQAX0ueVvKDCCIMEMSHdvnLbelNIAByYbVQvPREoq/aGMZQnHXol39oxiUb+n62xSjEuTCuv34eKHfr8st/trNeJpIq7zMmuhcYPIO6EEFjWqlHXVGM87nr1YTk1EYX+oDi3ThJGTFUEXhWOw7rx+nF6ti6hy4lLSVgXsD45A1LVHTNZ4scygoLBXfUXh29laZ8eyybANX6fOJ3CfN4YLPiVsydHm+Aq7B6GFGzJQX9iZEjSn1FRYEY=
  file: "$HOME/twrp/out/target/product/a8xelte/recovery.img"
  on:
    repo: TwrpBuilder/android_device_a8xelte
    branch: android-5.1
